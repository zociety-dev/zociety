#!/bin/bash
# Prevent direct commits to main branch
# To bypass (for emergencies): ALLOW_MAIN=1 git commit

BRANCH=$(git rev-parse --abbrev-ref HEAD 2>/dev/null)

if [[ "$BRANCH" == "main" && -z "$ALLOW_MAIN" && -z "$GITHUB_ACTIONS" ]]; then
    echo ""
    echo "â›” Direct commits to main are not allowed!"
    echo ""
    echo "Please use a feature branch:"
    echo "  git checkout -b feature/my-changes"
    echo "  git commit -m 'your message'"
    echo "  git push origin feature/my-changes"
    echo ""
    echo "To bypass (emergency only):"
    echo "  ALLOW_MAIN=1 git commit -m 'message'"
    echo ""
    exit 1
fi
